<project name="Revo" default="test" basedir=".">
    <description>
       Reta Vortaro, reguloj por (re)krei gxin. 
    </description>

<!-- alstrebu dosierujo-strukturon tian:

fonto en:
 
  xml/art
  xml/dok
  xml/xsl

rezulto en:

  html/art
  html/inx
  html/dok

-->



  <!-- legu agorditajn variablojn el dosiero -->
  <property file="${user.dir}/cfg/agordo" prefix="v."/>

  <!-- donu valorojn al la variabloj, se ili ne jam aperis en la agordo-dosiero -->
  <property name="v.voko" location="/home/revo/voko"/>
  <property name="v.voko.ant" location="${v.voko}/ant"/>
  <property name="v.bazo" location="${user.dir}"/>
  <property name="v.bazo.dok" location="${v.bazo}/dok"/>
  <property name="v.bazo.cfg" location="${v.bazo}/cfg"/>
  <property name="v.bazo.dtd" location="${v.bazo}/dtd"/>
  <property name="v.bazo.stl" location="${v.bazo}/stl"/>
  <property name="v.bazo.smb" location="${v.bazo}/smb"/>

  <property name="v.bazo.xml" location="${v.bazo}/xml"/>
  <property name="v.bazo.art" location="${v.bazo}/art"/>

  <property name="v.voko.bin" location="${v.voko}/bin"/>
  <property name="v.voko.xsl" location="${v.voko}/xsl"/>
  <property name="v.voko.cfg" location="${v.voko}/cfg"/>
  <property name="v.voko.dok" location="${v.voko}/dok"/>
  <property name="v.voko.dtd" location="${v.voko}/dtd"/>
  <property name="v.voko.stl" location="${v.voko}/stl"/>
  <property name="v.voko.smb" location="${v.voko}/smb"/>
  <!-- property name="tmp" location="/home/revo/tmp/inx_tmp"/ -->
  <property name="v.tmp" location="${v.bazo}/.tmp"/>
  <property name="v.outputformat" value="html"/>

  <property name="saxon" location="/usr/local/lib/saxon/saxon8.jar"/>


  <target name="preparo">
    <!-- Create the time stamp -->
    <tstamp/>
    <!-- Create the build directory structure used by compile -->
    <mkdir dir="${v.bazo.cfg}" />
    <mkdir dir="${v.bazo.dok}" />
    <mkdir dir="${v.bazo.dtd}" />
    <mkdir dir="${v.bazo.stl}" />
    <mkdir dir="${v.bazo.smb}" />
    <mkdir dir="${v.bazo.xml}" />
    <mkdir dir="${v.bazo.art}" />
  </target>


  <target name="agordo" description="eligas la agordeblajn variablojn por kontrolo">
    <echoproperties prefix="v."/>
  </target>


  <target name="kadro" depends="preparo" description="kreas index.hml kaj titolo.html el enhavo.xml">
    <xslt in="${v.voko.cfg}/enhavo.xml" out="${v.bazo}/index.html"
      style="${v.voko.xsl}/dok_enhavo.xsl"/>
  </target>


  <target name="bib" depends="preparo"
        description="bibliografio" >

    <xslt in="${v.voko.cfg}/bibliogr.xml" out="${v.bazo.dok}/bibliogr.html"
      style="${v.voko.xsl}/bibhtml.xsl"/>

    <xslt in="${v.voko.cfg}/bibliogr.xml" out="${v.bazo.dok}/biblaut.html"
      style="${v.voko.xsl}/bibauthtml.xsl"/>

    <xslt in="${v.voko.cfg}/bibliogr.xml" out="${v.bazo.dok}/bibltit.html"
      style="${v.voko.xsl}/bibtithtml.xsl"/>
  </target>

  <target name="dok" depends="preparo"
       description="diversaj dokumentoj">

    <copy todir="${v.bazo.cfg}">
      <fileset dir="${v.voko.cfg}" casesensitive="yes">
        <include name="*.xml"/>
      </fileset>
    </copy>

    <copy todir="${v.bazo.dok}">
      <fileset dir="${v.voko.dok}" casesensitive="yes">
        <include name="*.xml"/>
      </fileset>
    </copy>

    <xslt in="${v.voko.dok}/manlibro.xml" out="${v.bazo.dok}/manlibro.html"
       style="${v.voko.xsl}/manlibro.xsl"/>

    <xslt in="${v.voko.dok}/lingva_manlibro.xml" out="${v.bazo.dok}/lingva_manlibro.html"
       style="${v.voko.xsl}/manlibro.xsl"/>

<!--
    <exec dir="${revo}/dok" executable="perl">
       <arg file="${voko_bin}/dtd2html.pl"/>
       <arg file="${revo}/dtd/vokoxml.dtd"/>
    </exec>

    <exec dir="${revo}" executable="perl">
      <arg file="${voko_bin}/doklingv.pl"/>
    </exec>
-->

    <xslt in="${v.voko.cfg}/fakoj.xml" out="${v.bazo.dok}/fakoj.html"
       style="${v.voko.xsl}/dok_fakoj.xsl"/>

    <xslt in="${v.voko.cfg}/lingvoj.xml" out="${v.bazo.dok}/lingvoj.html"
       style="${v.voko.xsl}/dok_lingvoj.xsl"/>

    <xslt in="${v.voko.cfg}/stiloj.xml" out="${v.bazo.dok}/stiloj.html"
       style="${v.voko.xsl}/dok_stiloj.xsl"/>

    <xslt in="${v.voko.cfg}/mallongigoj.xml" out="${v.bazo.dok}/mallongigoj.html"
       style="${v.voko.xsl}/dok_mallongigoj.xsl"/>

  </target>


 <target name="dtd" depends="preparo"
       description="dokumenttip-difinoj">

    <copy todir="${v.bazo.dtd}">
      <fileset dir="${v.voko.dtd}" casesensitive="yes">
        <include name="*.dtd"/>
      </fileset>
    </copy>

  </target>

  <target name="stl" depends="preparo"
       description="kopias CSS-stildifinojn el voko">

    <copy todir="${v.bazo.stl}">
      <fileset dir="${v.voko.stl}" casesensitive="yes">
        <include name="*.*"/>
      </fileset>
    </copy>

  </target>

  <target name="smb" depends="preparo"
       description="kopias simbolojn el voko">

    <copy todir="${v.bazo.smb}">
      <fileset dir="${v.voko.smb}" casesensitive="yes">
        <include name="*.*"/>
      </fileset>
    </copy>

  </target>


  <target name="medio" depends="preparo,kadro,bib,dok,dtd,stl,smb"
     description="(re)kreas la medion por la vortaro, dosierujoj cfg,dok,dtd,stl,smb kun enhavo"/>


  <target name="html" depends="preparo" 
       description="(re)kreas indeksojn, tezauron kaj shanghitajn artikolojn en provizora dosierujo">
  
    <ant antfile="${v.voko.ant}/tezauro.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="tez-agordo"/>
       <target name="tez-html"/>
    </ant>

    <ant antfile="${v.voko.ant}/indeksoj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="inx-agordo"/>
       <target name="inx-cvs"/>
       <target name="inx-eraroj"/>
       <target name="inx-html"/>
    </ant>

    <ant antfile="${v.voko.ant}/artikoloj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="art-agordo"/>
       <target name="art-html"/>
    </ant>

  </target>


  <target name="limigita" depends="preparo" 
       description="shovas (re)kreitajn indeksojn, tezauron kaj artikolojn el provizora dosierujo al la vortaro,
         sed limigas kelkajn dosiernombrojn, ekz. maks. 1000 tezauro-dosierojn">
  
    <ant antfile="${v.voko.ant}/tezauro.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="tez-agordo"/>
       <target name="tez-mil"/>
    </ant>

    <ant antfile="${v.voko.ant}/indeksoj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="inx-agordo"/>
       <target name="inx-cvs"/>
       <target name="inx-eraroj"/>
       <target name="inx-tuto"/>
      </ant>

    <ant antfile="${v.voko.ant}/artikoloj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="art-agordo"/>
       <target name="art-tricent"/>
    </ant>

  </target>


  <target name="tuto" depends="preparo" 
       description="shovas (re)kreitajn indeksojn, tezauron kaj artikolojn el provizora dosierujo al la vortaro">
  
    <ant antfile="${v.voko.ant}/tezauro.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="tez-agordo"/>
       <target name="tez-tuto"/>
    </ant>

    <ant antfile="${v.voko.ant}/indeksoj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="inx-agordo"/>
       <target name="inx-cvs"/>
       <target name="inx-eraroj"/>
       <target name="inx-tuto"/>
      </ant>

    <ant antfile="${v.voko.ant}/artikoloj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="art-agordo"/>
       <target name="art-tuto"/>
    </ant>

  </target>


  <target name="pakajhoj" depends="preparo"
     description="faras pakajhojn de la vortaro post regulaj intervaloj">
       
     <ant antfile="${v.voko.ant}/pakajhoj.xml" inheritAll="false">   
       <property name="v.bazo" location="${v.bazo}"/>
       <target name="pak-agordo"/>
       <target name="pak-regule"/>
    </ant>
  </target>

</project>








